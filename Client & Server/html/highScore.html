<html>
	<head>
		
	</head>
	<body>
		<p id="demo">My First Paragraph</p>
	<script src="/socket.io/socket.io.js"></script><!-- Passed from the server -->
	<script>
	
			var socket = io.connect( '193.156.105.142:7541' );
			
			//
			//
			//
			function getCookie(c_name)
			{
				var i,x,y,ARRcookies=document.cookie.split(";");
				
				for (i=0;i<ARRcookies.length;i++){
			
					x=ARRcookies[i].substr(0,ARRcookies[i].indexOf("="));
					y=ARRcookies[i].substr(ARRcookies[i].indexOf("=")+1);
					x=x.replace(/^\s+|\s+$/g,"");
					if (x==c_name)
					{
						return unescape(y);
					}
				}
			}
		
			var userKey= getCookie("userKey");
	
			
			var score;
			var keyHolder;
			var gdata;
			// Register in the server again
			socket.emit( 'registerMeInServer', { userKey:userKey } );			
			
			socket.on( 'groupScore', function( data ){
			
				score=getCookie("score");
				//score = data.score;
				console.log("Score is: "+ score);
				keyHolder = data.keyHolder;
				console.log("Keyholder is : "+ keyHolder);
				gdata = data;
				console.log("the data was : "+ gdata);
				
				// The top score
				document.getElementById("demo").innerHTML="The total score for the group was : "+ data.score;	
				// The key holder
				document.getElementById("demo").innerHTML +="The user who got the key was : "+ keyHolder;
				// The individuals score
				document.getElementById("demo").innerHTML +="Your score was : "+ score;
				
			});
			
			
			// Loop until all the players have loaded the page.
			// Then check what the total score was.
			function hasFinished( ){				
				socket.emit( 'checkLoaded' );		
			};
			
			socket.on( 'hasFinished', function( ){
				// Get the scores for the game
				socket.emit('getGroupScore', getCookie("score") );	
			});
			
			hasFinished( );
			setInterval( "hasFinished()", 500 );
			
	</script>
	</body>
</html>